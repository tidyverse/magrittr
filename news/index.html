<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Changelog • magrittr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../.css" rel="stylesheet">




<meta property="og:title" content="Changelog" />
<meta property="og:image" content="https://magrittr.tidyverse.org/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-news">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">magrittr</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of the <a href="https://tidyverse.org">tidyverse</a></span>
          <span class="version version-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/magrittr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tradeoffs.html">Design tradeoffs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/tidyverse/magrittr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <h1 data-toc-skip>Changelog <small></small></h1>
      <small>Source: <a href='https://github.com/tidyverse/magrittr/blob/master/NEWS.md'><code>NEWS.md</code></a></small>
    </div>

    <div id="magrittr-1509000" class="section level1">
<h1 class="page-header" data-toc-text="1.5.0.9000">
<a href="#magrittr-1509000" class="anchor"></a>magrittr 1.5.0.9000<small> Unreleased </small>
</h1>
<div id="fast-and-lean-implementation-of-the-pipe" class="section level2">
<h2 class="hasAnchor">
<a href="#fast-and-lean-implementation-of-the-pipe" class="anchor"></a>Fast and lean implementation of the pipe</h2>
<p>The pipe has been rewritten in C with the following goals in mind:</p>
<ul>
<li>Minimal performance cost.</li>
<li>Minimal impact on backtraces.</li>
<li>No impact on reference counts.</li>
</ul>
<p>As part of this rewrite we have changed the behaviour of the pipe to make it closer to the implementation that will likely be included in a future version of R. The pipe now evaluates piped expressions lazily (<a href='https://github.com/tidyverse/magrittr/issues/120'>#120</a>). The main consequence of this change is that warnings and errors can now be handled by trailing pipe calls:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"foo"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/try.html">try</a></span>()
<span class="fu"><a href="https://rdrr.io/r/base/warning.html">warning</a></span>(<span class="st">"bar"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span>()</pre></div>
</div>
<div id="breaking-changes" class="section level2">
<h2 class="hasAnchor">
<a href="#breaking-changes" class="anchor"></a>Breaking changes</h2>
<p>The pipe rewrite should generally not affect your code. We have checked magrittr on 2800 CRAN packages and found only a dozen of failures.</p>
<div id="behaviour-of-return-in-a-pipeline" class="section level3">
<h3 class="hasAnchor">
<a href="#behaviour-of-return-in-a-pipeline" class="anchor"></a>Behaviour of <code>return()</code> in a pipeline</h3>
<p>The behaviour of <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> within pipe expressions was sort of undefined. Should it return from the current pipe expression, from the whole pipeline, or from the enclosing function? The behaviour that makes the most sense is to return from the enclosing function. However, we can’t make this work easily with the new implementation, and so calling <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> is now an error.</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="no">my_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {
  <span class="no">x</span> <span class="kw">%&gt;%</span> {
    <span class="kw">if</span> (<span class="no">.</span>) <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="st">"true"</span>)
    <span class="st">"false"</span>
  }
}

<span class="fu">my_function</span>(<span class="fl">TRUE</span>)
<span class="co">#&gt; Error: no function to return from, jumping to top level</span></pre></div>
<p>In magrittr 1.5, <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> used to return from the current pipe expression. You can rewrite this to the equivalent:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">my_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) {
  <span class="no">x</span> <span class="kw">%&gt;%</span> {
    <span class="kw">if</span> (<span class="no">.</span>) {
      <span class="st">"true"</span>
    } <span class="kw">else</span> {
      <span class="st">"false"</span>
    }
  }
}

<span class="fu">my_function</span>(<span class="fl">TRUE</span>)
<span class="co">#&gt; [1] "true"</span></pre></div>
<p>For backward-compatibility we have special-cased trailing <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> calls as this is a common occurrence in packages:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="fl">1</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/identity.html">identity</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>()</pre></div>
<p>Note however that this only returns from the pipeline, not the enclosing function:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">my_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>() {
  <span class="st">"value"</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/identity.html">identity</a></span>() <span class="kw">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>()
  <span class="st">"wrong value"</span>
}

<span class="fu">my_function</span>()
<span class="co">#&gt; [1] "wrong value"</span></pre></div>
<p>It is generally best to avoid using <code><a href="https://rdrr.io/r/base/function.html">return()</a></code> in a pipeline, even if trailing.</p>
</div>
<div id="failures-caused-by-laziness" class="section level3">
<h3 class="hasAnchor">
<a href="#failures-caused-by-laziness" class="anchor"></a>Failures caused by laziness</h3>
<p>With the new lazy model for the evaluation of pipe expressions, earlier parts of a pipeline are not yet evaluated when the last pipe expression is called. They only get evaluated when the last function actually uses the piped arguments:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">ignore</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="st">"return value"</span>
<span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="st">"never called"</span>) <span class="kw">%&gt;%</span> <span class="fu">ignore</span>()
<span class="co">#&gt; [1] "return value"</span></pre></div>
<p>This should generally not cause problems. However we found some functions with special behaviour, written under the assumption that earlier parts of the pipeline were already evaluated and had already produced side effects. This is generally incorrect behaviour because that means that these functions do not work properly when called with the nested form, e.g. <code>f(g(1))</code> instead of <code>1 %&gt;% g() %&gt;% f()</code>.</p>
<p>The solution to fix this is to call <code><a href="https://rdrr.io/r/base/force.html">force()</a></code> on the inputs to force evaluation, and only then check for side effects:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="no">my_function</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">data</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/force.html">force</a></span>(<span class="no">data</span>)
  <span class="fu">peek_side_effect</span>()
}</pre></div>
</div>
<div id="incorrect-call-stack-introspection" class="section level3">
<h3 class="hasAnchor">
<a href="#incorrect-call-stack-introspection" class="anchor"></a>Incorrect call stack introspection</h3>
<p>The magrittr expressions are no longer evaluated in frames that can be inspected by <code><a href="https://rdrr.io/r/base/sys.parent.html">sys.frames()</a></code> or <code><a href="https://rdrr.io/r/base/sys.parent.html">sys.parent()</a></code>. Using these functions for implementing actual functionality (as opposed as debugging tools) is likely to produce bugs. Instead, you should generally use <code><a href="https://rdrr.io/r/base/sys.parent.html">parent.frame()</a></code> which works even when R code is called from non-inspectable frames. This happens with e.g. <code><a href="https://rdrr.io/r/base/do.call.html">do.call()</a></code> and the new C implementation of magrittr.</p>
</div>
<div id="incorrect-assumptions-about-magrittr-internals" class="section level3">
<h3 class="hasAnchor">
<a href="#incorrect-assumptions-about-magrittr-internals" class="anchor"></a>Incorrect assumptions about magrittr internals</h3>
<p>Some packages were depending on how magrittr was internally structured. Robust code should only use the documented and exported API of other packages.</p>
</div>
</div>
<div id="bug-fixes" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-fixes" class="anchor"></a>Bug fixes</h2>
<ul>
<li><p>Can now use the placeholder <code>.</code> with the splicing operator <code>!!!</code> from rlang (<a href='https://github.com/tidyverse/magrittr/issues/191'>#191</a>).</p></li>
<li><p>Piped arguments are now persistent. They can be evaluated after the pipeline has returned, which fixes subtle issues with function factories (<a href='https://github.com/tidyverse/magrittr/issues/159'>#159</a>, <a href='https://github.com/tidyverse/magrittr/issues/195'>#195</a>).</p></li>
</ul>
</div>
</div>
    <div id="magrittr-15" class="section level1">
<h1 class="page-header" data-toc-text="1.5">
<a href="#magrittr-15" class="anchor"></a>magrittr 1.5<small> 2014-11-22 </small>
</h1>
<div id="new-features" class="section level2">
<h2 class="hasAnchor">
<a href="#new-features" class="anchor"></a>New features</h2>
<div id="functional-sequences" class="section level3">
<h3 class="hasAnchor">
<a href="#functional-sequences" class="anchor"></a>Functional sequences.</h3>
<p>A pipeline, or a “functional sequence”, need not be applied to a left-hand side value instantly. Instead it can serve as a function definition. A pipeline where the left-most left-hand side is the magrittr placeholder (the dot <code>.</code>) will thus create a function, which applies each right-hand side in sequence to its argument, e.g. <code>f &lt;- . %&gt;% abs %&gt;% mean(na.rm = TRUE)</code>.</p>
</div>
<div id="new-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#new-operators" class="anchor"></a>New operators</h3>
<p>Three new operators are introduced for some special cases</p>
<ul>
<li>Assignment pipe: <code><a href="../reference/compound.html">%&lt;&gt;%</a></code>
</li>
<li>Tee pipe: <code><a href="../reference/tee.html">%T&gt;%</a></code>
</li>
<li>Exposition pipe: <code><a href="../reference/exposition.html">%$%</a></code>
</li>
</ul>
<p>For more information see the documentation, e.g. <code>?%T&gt;%</code>.</p>
</div>
<div id="lambdas" class="section level3">
<h3 class="hasAnchor">
<a href="#lambdas" class="anchor"></a>Lambdas</h3>
<p>Lambdas can now be made by enclosing several statements in curly braces, and is a unary function of the dot argument.</p>
<p>For more information and examples, see the updated vignette, and help files.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>

</div>


      <footer>
      <div class="tidyverse">
  <p>magrittr is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="https://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>
    Developed by Stefan Milton Bache, <a href='http://hadley.nz'>Hadley Wickham</a>, <a href='https://www.rstudio.com'><img src='https://www.tidyverse.org/rstudio-logo.svg' alt='RStudio' height='24' /></a>.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


